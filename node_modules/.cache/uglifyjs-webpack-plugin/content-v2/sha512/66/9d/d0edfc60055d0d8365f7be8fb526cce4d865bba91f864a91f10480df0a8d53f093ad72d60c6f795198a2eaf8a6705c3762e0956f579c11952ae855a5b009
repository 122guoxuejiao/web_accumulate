{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{206:function(t,s,a){\"use strict\";a.r(s);var n=a(0),e=Object(n.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a(\"div\",{staticClass:\"content\"},[t._m(0),t._v(\" \"),t._m(1),t._v(\" \"),a(\"p\",[t._v(\"有一个任务非常耗时会消耗后台大量算力，所以在退出页面的时候，要求前端这边发送一个请求来杀死任务。\")]),t._v(\" \"),a(\"p\",[t._v(\"一开始以为这个需求非常简单，就是在进入其他路由前，发送一下请求，杀死 \\b 一下任务就好了。\")]),t._v(\" \"),a(\"p\",[t._v(\"然而现实狠狠的打了我的脸，因为退出页面的场景不止切换路由~\")]),t._v(\" \"),t._m(2),t._v(\" \"),t._m(3),t._v(\" \"),t._m(4),t._v(\" \"),t._m(5),t._v(\" \"),t._m(6),t._m(7),t._v(\" \"),t._m(8),t._v(\" \"),t._m(9),t._v(\" \"),t._m(10),t._v(\" \"),t._m(11),t._v(\" \"),t._m(12),t._m(13),t._v(\" \"),t._m(14),t._v(\" \"),a(\"p\",[t._v(\"return一个为true的值，下面这个弹窗就会出现\")]),t._v(\" \"),t._m(15),t._v(\" \"),t._m(16),t._v(\" \"),a(\"p\",[t._v(\"拦截不到，直接在地址栏跳转。\")]),t._v(\" \"),t._m(17),t._v(\" \"),a(\"p\",[t._v(\"觉得还不错的话，给我的项目点个\"),a(\"a\",{attrs:{href:\"https://github.com/OBKoro1/Brush_algorithm\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"star\"),a(\"OutboundLink\")],1),t._v(\"吧\")]),t._v(\" \"),a(\"p\",[a(\"a\",{attrs:{href:\"http://obkoro1.com/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"博客\"),a(\"OutboundLink\")],1),t._v(\"、\"),a(\"a\",{attrs:{href:\"https://github.com/OBKoro1/Brush_algorithm\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"前端算法\"),a(\"OutboundLink\")],1),t._v(\"、\"),a(\"a\",{attrs:{href:\"https://user-gold-cdn.xitu.io/2018/5/1/1631b6f52f7e7015?w=344&h=344&f=jpeg&s=8317\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"公众号\"),a(\"OutboundLink\")],1)])])},[function(){var t=this.$createElement,s=this._self._c||t;return s(\"h2\",{attrs:{id:\"退出页面发送请求\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#退出页面发送请求\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" 退出页面发送请求\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h3\",{attrs:{id:\"背景：\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#背景：\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" 背景：\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h3\",{attrs:{id:\"退出页面场景：\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#退出页面场景：\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" 退出页面场景：\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"ol\",[s(\"li\",[this._v(\"还在本网站，跳到其他路由\")]),this._v(\" \"),s(\"li\",[this._v(\"刷新页面/关闭页面\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h3\",{attrs:{id:\"还在本网站，跳到其他路由\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#还在本网站，跳到其他路由\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" 还在本网站，跳到其他路由\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"p\",[this._v(\"这个比较简单，\"),s(\"code\",[this._v(\"Vue\")]),this._v(\"中可以通过路由离开的钩子\"),s(\"code\",[this._v(\"beforeRouteLeave\")]),this._v(\"来实现：\")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a(\"div\",{staticClass:\"language-js line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[a(\"code\",[t._v(\" \"),a(\"span\",{attrs:{class:\"token function\"}},[t._v(\"beforeRouteLeave\")]),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"to\"),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),a(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"from\")]),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" next\"),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),a(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"if\")]),t._v(\" \"),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"任务运行中\"),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),a(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// 发送请求\")]),t._v(\"\\n    \"),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),a(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"else\")]),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),a(\"span\",{attrs:{class:\"token function\"}},[t._v(\"next\")]),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),a(\"span\",{attrs:{class:\"token boolean\"}},[t._v(\"true\")]),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),a(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// 用户离开\")]),t._v(\"\\n    \"),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n \"),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])]),t._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"7\")]),a(\"br\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h3\",{attrs:{id:\"搜索：https-segmentfault-com-a-1190000011851736\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#搜索：https-segmentfault-com-a-1190000011851736\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" 搜索：https://segmentfault.com/a/1190000011851736\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h3\",{attrs:{id:\"刷新页面-关闭页面\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#刷新页面-关闭页面\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" 刷新页面/关闭页面\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"p\",[this._v(\"然而在刷新页面的时候，\"),s(\"code\",[this._v(\"beforeRouteLeave\")]),this._v(\"并不会执行，显然这不符合我们的需求。\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"p\",[s(\"strong\",[this._v(\"beforeunload\")]),this._v(\"页面卸载之前:\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"p\",[this._v(\"通过面向 google 编程,找到了这个\"),s(\"code\",[this._v(\"API\")]),this._v(\",使用方法如下：\")])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a(\"div\",{staticClass:\"language-js line-numbers-mode\"},[a(\"pre\",{pre:!0,attrs:{class:\"language-js\"}},[a(\"code\",[a(\"span\",{attrs:{class:\"token comment\"}},[t._v(\"// 页面卸载之前\")]),t._v(\"\\nwindow\"),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\".\")]),a(\"span\",{attrs:{class:\"token function-variable function\"}},[t._v(\"onbeforeunload\")]),t._v(\" \"),a(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" e \"),a(\"span\",{attrs:{class:\"token operator\"}},[t._v(\"=>\")]),t._v(\" \"),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n  \"),a(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"if\")]),t._v(\" \"),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),t._v(\"任务运行中\"),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),a(\"span\",{attrs:{class:\"token comment\"}},[t._v('// 对话框默认的提示信息根据不同的浏览器有所不同，标准的信息类似 \"确定要离开此页吗？\"')]),t._v(\"\\n    \"),a(\"span\",{attrs:{class:\"token keyword\"}},[t._v(\"return\")]),t._v(\" \"),a(\"span\",{attrs:{class:\"token string\"}},[t._v(\"'对话框标题:在火狐等浏览器中生效'\")]),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\" \\n  \"),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\"),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),a(\"span\",{attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n\")])]),t._v(\" \"),a(\"div\",{staticClass:\"line-numbers-wrapper\"},[a(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"3\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"4\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"5\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"6\")]),a(\"br\"),a(\"span\",{staticClass:\"line-number\"},[t._v(\"7\")]),a(\"br\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"p\",[s(\"strong\",[this._v(\"对话框标题：\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"p\",[s(\"strong\",[this._v(\"不同浏览器有差异\")])])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"p\",[s(\"img\",{attrs:{src:\"http://ww1.sinaimg.cn/large/005Y4rCogy1fyr8kpadj0j30bt04vglt.jpg\",alt:\"\"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h3\",{attrs:{id:\"缺陷\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#缺陷\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" 缺陷\")])},function(){var t=this.$createElement,s=this._self._c||t;return s(\"h3\",{attrs:{id:\"鼓励我一下：\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#鼓励我一下：\",\"aria-hidden\":\"true\"}},[this._v(\"#\")]),this._v(\" 鼓励我一下：\")])}],!1,null,null,null);e.options.__file=\"退出页面发送请求.md\";s.default=e.exports}}]);","extractedComments":[]}